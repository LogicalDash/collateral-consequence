{% extends "layout.html" %}
{% block body %}
<div class="row">
    <div class="large-12 columns panel center">
        <h1 class="center">Results</h1>
    {{ count }} consequences were found. Click on the headings below to load them by category.
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="family">Family/Domestic Rights <button>View</button></h2>
        <div id="family-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="vehicle">Driver's Licenses <button>View</button></h2>
        <div id="vehicle-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="occupational">Work Licenses and Certifications <button>View</button></h2>
        <div id="occupational-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="benefits">Government Benefits <button>View</button></h2>
        <div id="benefits-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="housing">Housing <button>View</button></h2>
        <div id="housing-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="employment">Employment <button>View</button></h2>
        <div id="employment-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="registration">Registration, Notification, and Registry Restrictions <button>View</button></h2>
        <div id="registration-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="education">Education <button>View</button></h2>
        <div id="education-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="contracting">Government Contracting and Program Participation <button>View</button></h2>
        <div id="contracting-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="loans">Government Loans and Grants <button>View</button></h2>
        <div id="loans-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="recreational">Recreational and Weapons Licenses <button>View</button></h2>
        <div id="recreational-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="business">Business License and Other Property Rights <button>View</button></h2>
        <div id="business-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="political">Political and Civic Participation <button>View</button></h2>
        <div id="political-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>

    <div class="large-12 columns panel">
        <h2 class="center" id="judicial">Judicial Rights <button>View</button></h2>
        <div id="judicial-content">
            <h3>Mandatory/Automatic</h3>
            <ul class="mandatory"></ul>
            <h3>Background Check</h3>
            <ul class="background"></ul>
        </div>
    </div>
</div>

    

{% endblock %}

{% load static %}
{% block javascript %}
<script type="text/javascript">
    $(document).ready(function(){
        var targets = $("h2 button");
        targets.click(function(){
            $(this).css({"display": "none"});
            var parent = $(this).parent(),
                cat = $(parent).attr("id");
            get_consequences(cat);
        });

        function get_consequences(category){
            var fetch_me = "{% url 'api_consequences' query_params.state %}";
            fetch_me += "?consequence_cat=" + category;
            {% for offense in query_params.offense %}
                fetch_me += "&offense={{ offense }}";
            {% endfor %}
            {% if query_params.felony %}
                fetch_me += "&felony=True";
            {% endif %}
            {% if query_params.misdem %}
                fetch_me += "&misdem=True";
            {% endif %}
            {% if query_params.citizen %}
                fetch_me += "&citizen=True";
            {% endif %}
            {% if query_params.benefits %}
                fetch_me += "&benefits=True";
            {% endif %}
            {% if query_params.housing %}
                fetch_me += "&housing=True";
            {% endif %}

            $.get(fetch_me, function(data){
                // console.log(fetch_me);
                // console.log(data);
                var mandatory_list = $("#" + category + "-content ul.mandatory"),
                    bkgd_list = $("#" + category + "-content ul.background");

                for (var i=0; i < data.length; i++) {
                    var item = "<li>" + data[i].title + "</li>";
                    if (data[i].consequence_type[0] === "Mandatory/Automatic") {
                        mandatory_list.append(item);
                    } else {
                        bkgd_list.append(item);   
                    }

                }
            });
        };
    });
</script>
{% endblock %}